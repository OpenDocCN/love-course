# 课程 P1：最终一个人扛下了所有？ 🎬

在本节课中，我们将学习如何理解并处理一个常见的编程概念：**单例模式**。我们将探讨其核心思想、应用场景以及如何用代码实现它。

---

## 概述

单例模式是一种设计模式，它确保一个类只有一个实例，并提供一个全局访问点来获取这个实例。这在需要控制资源（如数据库连接、配置管理器）共享时非常有用。

上一节我们介绍了设计模式的基本概念，本节中我们来看看单例模式的具体实现。

---

## 核心概念与实现

单例模式的核心是**确保一个类只有一个实例**。这通常通过将类的构造函数设为私有，并提供一个静态方法来返回该类的唯一实例来实现。

以下是实现单例模式的关键步骤：

1.  **私有化构造函数**：防止外部通过 `new` 关键字创建多个实例。
2.  **创建私有静态实例变量**：用于保存类的唯一实例。
3.  **提供公共静态访问方法**：通常命名为 `getInstance()`，该方法负责创建（如果尚未创建）并返回唯一实例。

### 代码示例

让我们通过一个简单的 Java 代码示例来具体说明：

```java
public class Singleton {
    // 步骤2：创建私有静态实例变量
    private static Singleton instance;

    // 步骤1：私有化构造函数
    private Singleton() {
        // 初始化代码
    }

    // 步骤3：提供公共静态访问方法
    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }

    // 类的其他方法
    public void doSomething() {
        System.out.println("单例在工作。");
    }
}
```

在上面的代码中，`getInstance()` 方法在第一次被调用时会创建 `Singleton` 的唯一实例，后续调用则直接返回这个已创建的实例。

---

## 应用场景与注意事项

单例模式适用于哪些情况呢？以下是其主要应用场景：

*   **资源共享**：如数据库连接池、线程池、缓存、日志对象等，这些资源只需要一个实例来管理。
*   **配置管理**：应用程序的配置信息通常只需要一个全局对象来读取和存储。
*   **设备管理器**：例如打印机的后台处理服务，避免多个打印任务冲突。

然而，使用单例模式也需要注意：

*   **全局状态**：单例模式引入了全局状态，可能使代码的测试和调试变得复杂。
*   **线程安全**：上面的基础实现在多线程环境下可能创建多个实例。需要额外处理（如使用同步锁或“急切初始化”）来保证线程安全。

---

## 总结

本节课中我们一起学习了**单例模式**。我们了解了它的定义是确保一个类仅有一个实例，并提供了全局访问点。我们通过一个简单的 Java 代码示例，拆解了实现单例模式的三个关键步骤。最后，我们讨论了它的典型应用场景以及使用时需要注意的线程安全等问题。掌握单例模式有助于你在合适的场景下更好地管理资源和对象实例。